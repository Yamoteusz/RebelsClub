<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rebels Club â€” klub sportÃ³w walki</title>
  <meta name="description" content="Rebels Club â€” klub sportÃ³w walki w TwardogÃ³rze. Kickboxing, boks, MMA." />
<!-- <link rel="icon" href="/images/uploads/favicon.ico" /> -->
  <link rel="icon" type="images/uploads/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="images/uploads/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="images/uploads/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="RebelsClub" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <nav class="nav">
    <div class="container nav-inner">
      <div class="brand">
        <img class="brand-logo" src="images/uploads/rebels.png" alt="Rebels Club" />
        <!-- <div class="brand-mark" aria-hidden="true">R</div> -->
        <a href="#top" aria-label="Rebels Club â€” strona gÅ‚Ã³wna" class="club-name">Rebels Club</a>
      </div>
      <div class="nav-links" role="navigation" aria-label="GÅ‚Ã³wna nawigacja">
        <a href="#o-nas">O nas</a>
        <a href="#trenerzy">Trenerzy</a>
        <a href="#zawodnicy">Zawodnicy</a>
        <a href="#grafik">Grafik</a>
        <a href="#cennik">Cennik</a>
        <a href="#regulamin">Regulamin</a>
        <a href="#aktualnosci">AktualnoÅ›ci</a>
        <a href="#kontakt" class="btn">DoÅ‚Ä…cz</a>
        <div id="auth-menu"></div>
      </div>
      <button class="nav-toggle btn btn-outline" onclick="document.querySelector('.nav-links')?.classList.toggle('open')">Menu</button>
    </div>
  </nav>

  <header class="hero" id="top">
    <div class="container hero-grid">
      <div>
        <span class="chip motto" aria-label="Motto klubu">Dyscyplina â€¢ Charakter â€¢ Rebelia</span>
        <h1 class="club-name">Rebels Club â€” klub sportÃ³w walki</h1>
        <p>Kickboxing â€¢ Boks â€¢ MMA. <strong class="cta-text"></strong>.</p>
        <div class="hero-cta">
          <a class="btn" href="#kontakt" id="cta-trening">Skontaktuj siÄ™ z nami</a>
          <a href="#grafik" class="btn btn-outline" aria-label="Zobacz grafik">Zobacz grafik</a>
        </div>
        <div id="stats" style="display:flex; gap:10px; margin-top:16px; flex-wrap:wrap;"></div>
      </div>
      <div class="hero-card" aria-label="Grafik skrÃ³t">
        <h3 style="margin:0 0 8px">Dzisiejsze treningi</h3>
        <p class="meta" id="today-date">â€”</p>
        <div id="hero-trainings" class="cards" style="grid-template-columns:1fr;"></div>
        <a href="#grafik" class="btn" style="margin-top:12px">PeÅ‚ny grafik</a>
      </div>
    </div>
  </header>

  <section id="o-nas"><div class="container"><div class="sec-head"><h2 class="sec-title">O nas</h2><span class="chip">#RebelsFightTogether</span></div><p>Rebels Club to miejsce, w ktÃ³rym <strong>dyscyplina</strong> spotyka <strong>pasjÄ™</strong>. Uczymy fundamentÃ³w i pomagamy rozwijaÄ‡ siÄ™ zawodnikom â€” w ringu i poza nim. Stawiamy na technikÄ™, kondycjÄ™ oraz mental.</p></div></section>

  <section id="trenerzy"><div class="container"><div class="sec-head"><h2 class="sec-title">Trenerzy</h2></div><div class="cards" id="trainers"></div></div></section>

  <section id="zawodnicy"><div class="container"><div class="sec-head"><h2 class="sec-title">Zawodnicy</h2></div><div class="cards" id="athletes"></div></div></section>

  <section id="grafik"><div class="container"><div class="sec-head"><h2 class="sec-title">Grafik treningÃ³w</h2></div><div class="card"><div class="card-body" style="overflow:auto;"><table class="table"><thead><tr><th>DzieÅ„</th><th>Godzina</th><th>Grupa</th><th>Trener</th><th>Sala</th></tr></thead><tbody id="schedule-body"></tbody></table></div></div></div></section>

  <section id="cennik"><div class="container"><div class="sec-head"><h2 class="sec-title">Cennik</h2></div><div class="price-grid" id="pricing"></div><p class="kudos">* ZniÅ¼ki dla rodzeÅ„stw i uczniÃ³w â€” zapytaj w recepcji.</p></div></section>

  <section id="regulamin"><div class="container"><div class="sec-head"><h2 class="sec-title">Regulamin klubu</h2></div><div class="card"><div class="card-body" id="rules"></div></div></div></section>

  <section id="aktualnosci"><div class="container"><div class="sec-head"><h2 class="sec-title">AktualnoÅ›ci</h2></div><div class="cards" id="news" style="grid-template-columns:1fr;"></div></div></section>

  <section id="kontakt">
    <div class="container">
      <div class="sec-head">
        <h2 class="sec-title">Kontakt</h2>
      </div>
      <div class="card" id="contact-block">
        <div class="card-body">
          <!-- Wycentrowana mapa -->
          <div style="display:grid; place-items:center;">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2367.689219869897!2d17.14223481576889!3d51.29918368202716!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x470ff6d5f8a99fdb%3A0xa7eec303db15d1d5!2zVHBvZG9n3PTQJQmJhSW9cQxg!5e0!3m2!1spl!2spl!4v1636578152762!5m2!1spl!2spl" style="width:100%; height: 400px; border:0; margin-top: 10px;" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="sponsorzy">
    <div class="container">
      <div class="sec-head">
        <h2 class="sec-title">Partnerzy / Sponsorzy</h2>
      </div>
      <div class="sponsors-grid" id="sponsors"></div>
    </div>
  </section>


  <footer><div class="container footer-grid"><div><div class="brand" style="margin-bottom:8px;"><img class="brand-logo" src="images/uploads/rebels.png" alt="Rebels Club" /><strong class="club-name">Rebels Club</strong></div><p class="meta">Â© <span id="year"></span> <span class="club-name">Rebels Club</span>. Wszelkie prawa zastrzeÅ¼one.</p></div><div><div class="meta"></div></div></div></div></footer>
  <script src="js/app.js"></script>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on('init', user => {
        if (!user) {
          window.netlifyIdentity.on('login', () => {
            document.location.href = '/admin/';
          });
        }
      });
    }
  </script>

  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    const el = document.getElementById('auth-menu');
    let globalClosersBound = false;

    function closeAllMenus(){
      document.querySelectorAll('.dropdown[data-open="1"]').forEach(d=>{
        d.setAttribute('hidden','');
        d.removeAttribute('data-open');
      });
      document.querySelectorAll('.menu-btn[aria-expanded="true"]').forEach(b=>b.setAttribute('aria-expanded','false'));
    }

    function bindGlobalClosersOnce(){
      if (globalClosersBound) return;
      globalClosersBound = true;
      document.addEventListener('click', closeAllMenus);
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeAllMenus(); });
      window.addEventListener('scroll', closeAllMenus, { passive:true });
    }

    function rolesOf(user){ return (user?.app_metadata?.roles) || []; }

    function renderMenu(user){
      if(!el) return;
      if(!user){
        el.innerHTML = `
          <div class="user-menu">
            <button class="btn" id="btn-login">Zaloguj / Zarejestruj</button>
          </div>`;
        document.getElementById('btn-login')?.addEventListener('click', e=>{
          e.preventDefault(); window.netlifyIdentity?.open();
        });
        return;
      }

      const email = user.email || 'UÅ¼ytkownik';
      const staff = rolesOf(user).some(r=>['staff','editor','admin'].includes(r));
      el.innerHTML = `
        <div class="user-menu">
          <button class="menu-btn" id="menuBtn" aria-haspopup="true" aria-expanded="false">
            <span class="avatar">${email[0].toUpperCase()}</span>
            <span class="email">${email}</span>
          </button>
          <div class="dropdown" id="menuDrop" hidden>
            ${staff ? '<a href="/admin/">ðŸ›  CMS</a>' : ''}
            <button id="btn-logout">ðŸšª Wyloguj</button>
          </div>
        </div>`;

      const btn  = document.getElementById('menuBtn');
      const drop = document.getElementById('menuDrop');

      // nie pozwÃ³l, by klik w dropdown zamykaÅ‚ go natychmiast
      drop.addEventListener('click', e=> e.stopPropagation());

      btn.addEventListener('click', (e)=>{
        e.preventDefault();
        e.stopPropagation();
        const isOpen = drop.getAttribute('data-open') === '1';
        closeAllMenus();
        if (!isOpen){
          drop.removeAttribute('hidden');
          drop.setAttribute('data-open','1');
          btn.setAttribute('aria-expanded','true');
        } else {
          drop.setAttribute('hidden','');
          drop.removeAttribute('data-open');
          btn.setAttribute('aria-expanded','false');
        }
      });

      document.getElementById('btn-logout')?.addEventListener('click', ()=> window.netlifyIdentity?.logout());
      bindGlobalClosersOnce(); // tylko raz na caÅ‚Ä… stronÄ™
    }

    // Identity bez reloadÃ³w
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on('init',  user => renderMenu(user));
      window.netlifyIdentity.on('login', user => renderMenu(user));
      window.netlifyIdentity.on('logout',()   => renderMenu(null));
      setTimeout(()=> renderMenu(window.netlifyIdentity.currentUser()), 150);
    } else {
      renderMenu(null);
    }
  </script>



  
</body>
</html>